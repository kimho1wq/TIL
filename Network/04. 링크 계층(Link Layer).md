## 링크 계층(Link Layer)

### 1. 링크 계층 개요
- 링크 계층 개요
  - 링크 계층의 기본 서비스는 단일 통신 링크상으로 데이터그램을 한 노드에서 인접 노드로 이동 시키는 것
  - 네트워크 계층 데이터그램을 링크상으로 전송하기 전에 링크 계층 프레임에 캡슐화 한다
  - 매체 접속 제어(MAC, medium access control) 프로토콜은 링크상으로 프레임을 전송하는 규칙에 대해서 명시한다
  - 프레임에 오류 검출 비트를 설정하게 하고 수신 노드에서 오류 검사를 수행하며, 대부분의 링크 계층 프로토콜은 오류를 검출하는 방법을 제공한다
- 링크 계층이 구현되는 위치
  - ![image](https://github.com/kimho1wq/TIL/assets/15611500/ccff76dd-6dcf-441d-8de6-96fe334b418e)
  - 대부분의 링크 계층은 네트워크 인터페이스 카드(NIC, network interface card)로 알려진 네트워크 어댑터(network adapter)에 구현된다
  - 네트워크 어댑터의 중심에는 링크 계층 제어기가 있으며, 링크 계층 서비스(프레임화, 링크 접속, 오류 검출 등)가 구현되어 있는 단일의 특수 칩이다
  - 송신 측의 제어기는 호스트 메모리에 저장된 데이터그램을 링크 계층 프레임으로 캡슐화 한 후, 이 프레임을 통신 링크상으로 전송한다

### 2. 스위치 근거리 네트워크
- MAC(Media Access Control) 주소
  - 링크 계층 주소를 의미하며 어댑터(네트워크 인터페이스)에 저장되어 있고 랜 주소(LAN address) 또는 물리 주소(physical address)라고도 한다
  - MAC 주소는 길이가 6바이트이며, 어떠한 어댑터도 동일한 주소를 갖지 않는다 (IEEE가 MAC 주소 공간을 관리한다)
  - IP 주소는 호스트가 이동하면 다른 네트워크에 접속하면서 주소가 변경되는 계층구조 이지만, MAC 주소는 유일하게 부여되는 주소로 평면 구조이다
  - 스위치는 종종 프레임을 자신의 모든 인터페이스로 브로드캐스트(FF-FF-FF-FF-FF-FF)하고, 수신한 어댑터는 프레임 안의 목적지 MAC 주소가 어댑터 자신의 MAC 주소와 일치하면 데이터그램을 추출한다
- ARP(Address Resolution Protocol)
  - 네트워크 계층 주소(IP 주소)와 링크 계층 주소(MAC 주소)를 변환해주는 프로토콜
  - 데이터그램을 전송하기 위해서는 출발지 노드에서 자신의 어댑터에게 IP 주소 뿐만 아니라 MAC 주소도 주어야 한다
  - ARP는 동일한 서브넷상에 있는 IP 주소만을 해결하고, ARP 테이블에 목적지 노드가 없으면 ARP 패킷을 이용하여 서브넷에 질의한다
  - 각 호스트와 라우터 인터페이스는 자신의 메모리에 ARP 테이블을 갖고 있어서 IP 주소와 MAC 주소 간의 매핑을 수행한다
  - 각 호스트와 라우터 인터페이스는 하나의 IP 주소와 하나의 어댑터를 가진다
  - ![image](https://github.com/kimho1wq/TIL/assets/15611500/70875deb-45a3-4d82-b1dc-b6cb9cc374c4)
- 이더넷(Ethernet)
  - 하나의 인터넷 회선에서 공유기를 통해 다수의 시스템이 랜선에 연결되어 통신이 가능한 네트워크 구조를 말한다
  - 일반적으로 사용되는 LAN에서 가장 많이 활용되는 기술 규격으로 IEEE 802.3 규약으로 표준화되었다
  - 이더넷은 각 기기들이 고유의 MAC 주소를 가지고 이 주소를 이용해 상호간에 데이터를 주고 받을 수 있으며 각 기기들은 허브(hub), 스위치(switch) 등의 장치로 연결된다
- 스위치(Switch)
  - 링크 계층 프레임을 수신해서 출력 링크로 전달하는 것으로, 호스트와 라우터는 중간에 스위치가 프레임을 받아서 다른 노드에게 전달하는 것을 알지 못한다(투명하다, transparent)
  - 프레임을 인터페이스로 전달 또는 폐기할지 결정하고(여과, filtering) 프레임이 전송될 인터페이스를 결정하고 내보낸다(전달, forwarding)
  - 스위치의 여과와 전달은 스위치 테이블(switch table)을 이용하고, 스위치 출력 인터페이스도 버퍼를 갖고 있다
  - ![image](https://github.com/kimho1wq/TIL/assets/15611500/3f8856c1-5ef0-47ae-aa05-b893c168158f)
- 가상 근거리 네트워크(VLAN, Virtual LAN)
  - VLAN을 지원하는 장비로 만든 하나의 물리적 근거리 네트워크 기반구조에서 여러 개의 가상 LAN을 정의할 수 있게 한다
  - 하나의 VLAN의 포트들은 하나의 브로드캐스트 도메인을 형성하고, 프레임에 VLAN을 구별해주는 4바이트 VLAN Tag 헤더를 갖고 있다
  - ARP나 DHCP와 같은 브로드캐스트 트래픽의 전달 범위를 제한시켜서 랜 성능을 향상시킬 수 있고, 브로드캐스트 트래픽을 제한시켜 보안에 더 신경쓸 수 있다
  - 한 개의 스위치로 여러개의 효과를 낼 수 있고, 물리적인 방법이 아니라 소프트웨어적 방법으로 네트워크를 분리 시킬 수 있다
  - ![image](https://github.com/kimho1wq/TIL/assets/15611500/d4c8b5a4-9172-4e99-bbb4-b59684a93bfd)


















