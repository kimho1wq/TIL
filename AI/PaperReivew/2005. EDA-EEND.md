# End-to-End Speaker Diarization for an Unknown Number of Speakers with Encoder-Decoder Based Attractors


## Introduction

기존 SA-EEND의 flexible 하지 못한 한계점을 encoder-decoder based attractor(EDA) calculation으로 해결하기 위한 방법

SA-EEND의 마지막 Fully-Connected layer의 weight (S x D, S: max number of speaker, D: hidden dim)를 사용한다면 test시에도 학습된 고정된 speaker attractor (weight)를 사용하여 최적의 speaker attractor가 아닐 수도 있다

network structure에 따라 maximum speaker의 수가 정해져 있다면, 실제 사용하는 inference에서 cluster의 한계가 정해지게 된다
 
또한 SA-EEND는 3명 이상인 경우, x-vector 보다 성능이 좋지 않음(여러 명의 경우 Relation information 을 잘 해석하지 못함)

기존의 고정된 화자 수와 weight 값 형태로 고정되어 있던 speaker attractor를 LSTM 기반 EDA로 부터 추출하여 사용하는 방법

EDA는 speech embedding sequences와 multiple attractors를 dot products를 사용하여 같은 수의 speaker activites를 생성한다

EEND에서 나온 SAD 결과만을 사용하는 것이 아닌, SAD 만을 담당하는 모듈로 부터 나온 결과를 이용한 후 처리 알고리즘을 제안

EEND-EDA도 여전히 학습되지 않은 화자 수에 경우 찾지 못하는 단점을 가지고 있기 때문에
Iterative inference 라는 방법을 이용해 많은 화자수가 존재하는 경우에 찾아내는 방법을 제안함


## Proposed method

### Encoder-decoder based attractor calculation

기본적으로 SA-EEND의 Encoder Block을 앞단에 동일하게 사용하여 embedding을 출력하고,
SA-EEND에서 사용하던 마지막 Linear 대신에 이를 LSTM 기반 Encoder-Decoder Attractor(EDA)의 출력 Attractor를 이용한다

EDA는 SA-EEND에서 생성한 Embedding 의 상태를 살펴보고, 이에 맞는 적절한(가변적인) 화자 수와 Speaker Attractor vector를 생성하여 처리한다




















